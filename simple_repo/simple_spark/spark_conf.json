{
    "spark": [
        {
            "node_id": "load",
            "node": "simple_repo.simple_spark.load.loader.SparkCSVLoader",
            "parameters": {
                "path": "simple_spark/spark.csv",
                "header": true,
                "schema": true
            },
            "then": [
                {
                    "send_to": "filter",
                    "dataset": "dataset"
                }
            ]
        },
        {
            "node_id": "filter",
            "node": "simple_repo.simple_spark.transform.data_wrangling.SparkColumnSelector",
            "parameters": {
                "features": [
                    {
                        "col": "id",
                        "value": "id < 9"
                    },
                    {
                        "col": "text"
                    },
                    {
                        "col": "label",
                        "value": "label != 2.0"
                    }
                ]
            },
            "then": [
                {
                    "send_to": "split",
                    "dataset": "dataset"
                }
            ]
        },
        {
            "node_id": "split",
            "node": "simple_repo.simple_spark.transform.data_wrangling.SparkSplitDataset",
            "parameters": {
                "train": 0.7,
                "test": 0.3
            },
            "then": [
                {
                    "send_to": "pipeline",
                    "dataset": "dataset"
                }
            ]
        },
        {
            "node_id": "pipeline",
            "node": "simple_repo.simple_spark.pipeline.spark_pipeline.SparkPipelineNode",
            "parameters": {
                "stages": [
                    {
                        "name": "simple_repo.simple_spark.pipeline.stages.Tokenizer",
                        "param": {
                            "inCol": "text",
                            "outCol": "words"
                        }
                    },
                    {
                        "name": "simple_repo.simple_spark.pipeline.stages.HashingTF",
                        "param": {
                            "inCol": "words",
                            "outCol": "features"
                        }
                    },
                    {
                        "name": "simple_repo.simple_spark.pipeline.stages.LogisticRegression",
                        "param": {
                            "maxIter": 10,
                            "regParam": 0.001
                        }
                    }
                ]
            },
            "then": [
                {
                    "send_to": "output",
                    "model": "model"
                }
            ]
        },
        {
            "node_id": "output",
            "node": "simple_repo.simple_spark.output.output_step.SaveModel",
            "parameters": {
                "path": "simple_spark/model"
            }
        }
    ]
}
